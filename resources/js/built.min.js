var xhrUtils=function(){function a(a,b,c,d){f("GET",null,a,b,c,d)}function b(a,b,c){f("GET",null,null,a,b,c)}function c(a,b,c,d){f("POST",a,null,b,c,d)}function d(a,b,c,d,e){f("PUT",a,b,c,d,e)}function e(a,b,c,d){f("DELETE",null,a,b,c,d)}function f(a,b,c,d,e,f){var g=new XMLHttpRequest,h=c?c:"",i="http://localhost:3000/"+d+"/"+h;g.open(a,i,!0),g.setRequestHeader("Content-Type","application/json"),g.send(b?JSON.stringify(b):null),g.addEventListener("load",function(){console.log("Request complete"),200===g.status||201===g.status?(console.log("Success!!!"),e&&e(JSON.parse(g.responseText),g)):f&&f(JSON.parse(g.responseText))})}function g(a){console.error(a)}return{getByID:a,getAll:b,create:c,update:d,deleteRecord:e,failedRequest:g}}();!function(){function a(a){o=a;for(var b in a)d(a[b])}function b(b){g.innerHTML="",c(b),a(o)}function c(a){var b={NameA:function(a,b){var c=a.name,d=b.name;return c===d?0:d>c?-1:1},NameZ:function(a,b){var c=a.name,d=b.name;return c===d?0:c>d?-1:1},DateNew:function(a,b){var c=a.id,d=b.id;return c===d?0:c>d?-1:1},DateOld:function(a,b){var c=a.id,d=b.id;return c===d?0:d>c?-1:1},SubjA:function(a,b){var c=a.name,d=b.name;return c===d?0:d>c?-1:1},SubjZ:function(a,b){var c=a.name,d=b.name;return c===d?0:c>d?-1:1}};o.sort(b[a])}function d(a){var b=f(a);n.push(b),g.appendChild(b)}function e(){v.addEventListener("click",function(a){""==s.value&&(p.classList.add("has-error"),w.classList.add("commErr"),a.preventDefault()),""==t.value&&(q.classList.add("has-error"),x.classList.add("commErr"),a.preventDefault()),""==u.value?(r.classList.add("has-error"),y.classList.add("commErr"),a.preventDefault()):xhrUtils.create({name:s.value,subj:t.value,body:u.value,date:moment().format("MMMM Do YYYY, HH:mm:ss")},"comment",function(a){d(a)})}),s.addEventListener("blur",function(a){""!==s.value&&(p.classList.remove("has-error"),w.classList.remove("commErr"),console.log(a))}),t.addEventListener("blur",function(a){""!==t.value&&(q.classList.remove("has-error"),x.classList.remove("commErr"),console.log(a))}),u.addEventListener("blur",function(a){""!==u.value&&(r.classList.remove("has-error"),y.classList.remove("commErr"),console.log(a))})}function f(a){function b(){h=document.createElement("div"),h.classList.add("panel"),h.classList.add("panel-default"),i=document.createElement("div"),i.classList.add("panel-heading"),j=document.createElement("strong"),l=document.createElement("span"),l.classList.add("text-muted"),l.classList.add("italic"),k=document.createElement("button"),k.classList.add("btn"),k.classList.add("btn-default"),k.classList.add("btn-xs"),k.style["float"]="right",k.innerHTML="Delete",m=document.createElement("div"),p=document.createElement("p"),n=document.createElement("h5"),o=document.createElement("hr"),o.classList.add("small"),n.classList.add("comment-head"),m.classList.add("panel-body"),n.setAttribute("contenteditable",""),p.setAttribute("contenteditable",""),q.appendChild(h),h.appendChild(i),i.appendChild(j),i.appendChild(l),i.appendChild(k),h.appendChild(m),m.appendChild(n),m.appendChild(o),m.appendChild(p)}function c(){n.addEventListener("blur",function(a){d(),console.log(a)}),p.addEventListener("blur",function(a){d(),console.log(a)}),k.addEventListener("click",function(a){xhrUtils.deleteRecord(g,"comment",function(){e()},xhrUtils.failedRequest)})}function d(){a.subj=n.innerHTML,a.body=p.innerHTML,a.date=l.innerHTML,l.innerHTML=moment().format("MMMM Do YYYY, HH:mm:ss"),xhrUtils.update(a,g,"comment"),console.log(a)}function e(){q.remove()}function f(){j.innerHTML=a.name,n.innerHTML=a.subj,p.innerHTML=a.body,l.innerHTML=" "+a.date}var g,h,i,j,k,l,m,n,o,p;g=a.id;var q=document.createElement("div");return q.classList.add("col-md-6"),b(),f(),c(),q}var g=document.getElementById("comment-block"),h=document.getElementById("nameA"),i=document.getElementById("nameZ"),j=document.getElementById("dateNew"),k=document.getElementById("dateOld"),l=document.getElementById("subjA"),m=document.getElementById("subjZ"),n=[],o=[];g.innerHTML="";var p=(document.getElementById("review"),document.getElementById("nameErr")),q=document.getElementById("subjErr"),r=document.getElementById("textErr"),s=document.getElementById("name"),t=document.getElementById("subj"),u=document.getElementById("review"),v=document.getElementById("create"),w=document.getElementById("nameTextErr"),x=document.getElementById("subjTextErr"),y=document.getElementById("comTextErr");xhrUtils.getAll("comment",a,xhrUtils.failedRequest),h.addEventListener("click",function(a){b("NameA")}),i.addEventListener("click",function(a){b("NameZ")}),j.addEventListener("click",function(a){b("DateNew")}),k.addEventListener("click",function(a){b("DateOld")}),l.addEventListener("click",function(a){b("SubjA")}),m.addEventListener("click",function(a){b("SubjZ")}),e()}(),function(a){"use strict";a("a.page-scroll").bind("click",function(b){var c=a(this);a("html, body").stop().animate({scrollTop:a(c.attr("href")).offset().top-50},1250,"easeInOutExpo"),b.preventDefault()}),a("body").scrollspy({target:".navbar-fixed-top",offset:51}),a(".navbar-collapse ul li a").click(function(){a(".navbar-toggle:visible").click()}),a("#mainNav").affix({offset:{top:100}}),(new WOW).init()}(jQuery);